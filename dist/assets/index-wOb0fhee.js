(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function a(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=a(t);fetch(t.href,n)}})();class f{static instance;images;constructor(){this.images=new Map}static getInstance(){return f.instance||(f.instance=new f),f.instance}loadImage(e){return new Promise((a,s)=>{if(this.images.has(e)){a(this.images.get(e));return}const t=new Image;t.onload=()=>{this.images.set(e,t),a(t)},t.onerror=s,t.src=e})}async getImage(e){return this.images.has(e)||await this.loadImage(e),this.images.get(e)}}class L{x;y;width;height;color;speed;image;constructor(e,a,s,t,n,o){this.x=e,this.y=a,this.width=s,this.height=t,this.color=n,this.speed=o,this.image=new Image}draw(e){f.getInstance().getImage("/games/game1/assets/images/alien1.jpg").then(a=>{a&&e.drawImage(a,this.x,this.y,this.width,this.height)})}update(e){this.y+=this.speed*e/1e3}}class R{x;y;vx;vy;length;color;constructor(e,a,s,t,n,o){this.x=e,this.y=a,this.vx=s,this.vy=t,this.length=n,this.color=o}draw(e){e.beginPath(),e.fillStyle=this.color,e.arc(this.x,this.y,this.length/2,0,Math.PI*2),e.fill(),e.closePath()}update(e){this.y+=this.vy*e/1e3}}class ${x;y;width;height;displayEndTime;shouldDisplay=!0;constructor(e,a,s,t,n){this.x=e,this.y=a,this.width=s,this.height=t,this.displayEndTime=n}draw(e){this.shouldDisplay&&f.getInstance().getImage("/games/game1/assets/images/explosion.jpg").then(a=>{a&&e.drawImage(a,this.x,this.y,this.width,this.height)})}update(e){e>=this.displayEndTime&&(this.shouldDisplay=!1)}}class X{x;y;width;height;color;speed;currentSpeed;constructor(e,a,s,t,n,o){this.x=e,this.y=a,this.width=s,this.height=t,this.color=n,this.speed=o,this.currentSpeed=0}draw(e){e.beginPath(),e.moveTo(this.x-this.width/2,this.y+this.height/3),e.lineTo(this.x,this.y-this.height/3*2),e.lineTo(this.x+this.width/2,this.y+this.height/3),e.closePath(),e.strokeStyle=this.color,e.stroke(),e.fillStyle=this.color,e.fill()}update(e,a){let s=this.x;this.x+=this.currentSpeed*e/1e3,(this.x>a.canvas.width-this.width/2||this.x<this.width/2)&&(this.x=s)}}class F{x;y;radius1;radius2;blinkIntervalInMs;speedPerSecond;lastBlinkTimeInMs=0;currentRadiusType=0;lastUpdateTimeInMs=0;constructor(e,a,s,t,n){this.x=e,this.y=a,this.radius1=s,this.radius2=t,this.blinkIntervalInMs=1e3+Date.now()%3e3,this.speedPerSecond=n}drawStar(e,a){let s=0;e-this.lastBlinkTimeInMs>this.blinkIntervalInMs&&(this.lastBlinkTimeInMs=e,this.currentRadiusType++),s=this.currentRadiusType%2===0?this.radius1:this.radius2,a.beginPath();try{a.arc(this.x,this.y,s,0,Math.PI*2,!0),a.fillStyle="white",a.fill(),a.beginPath(),a.fillRect(this.x-s*.75,this.y-s*.75,s*1.5,s*1.5),a.beginPath(),a.translate(this.x,this.y),a.rotate(Math.PI/4),a.fillRect(-s*.75,-s*.75,s*1.5,s*1.5)}finally{a.resetTransform()}}update(e){let a=e/1e3*this.speedPerSecond;this.y+=a}}class l{static instance;soundToAudioBufferMap;audioContext;constructor(e){this.audioContext=e,this.soundToAudioBufferMap=new Map}static getInstance(e){return l.instance||(l.instance=new l(e)),l.instance}loadSoundPool(e){return new Promise((a,s)=>{this.soundToAudioBufferMap.has(e)?a(this.soundToAudioBufferMap.get(e)):fetch(e).then(t=>t.arrayBuffer()).then(t=>{this.audioContext.decodeAudioData(t).then(n=>{this.soundToAudioBufferMap.set(e,n),a(n)})}).catch(s)})}async getAudioBufferSource(e){const a=await this.loadSoundPool(e),s=this.audioContext.createBufferSource();return s.buffer=a,s.connect(this.audioContext.destination),s}}let r,d=[],h=[],u=[],g=-1,H=1,K=5,q=5,O=0,C=0,v=0,w=0,p=[],P,m,T,b,I,M,D,G=20,E=!1,c=!1,y=!1;const x=new(window.AudioContext||window.webkitAudioContext);function j(){const i=document.getElementById("gameCanvas");if(!i){console.error("Canvas element not found!");return}const e=i.getContext("2d");if(!e){console.error("Failed to get 2D context!");return}i.width=window.innerWidth,i.height=window.innerHeight,e.fillStyle="black",e.clearRect(0,0,i.width,i.height),V(e),I=50,M=I,D=i.width/4,r=new X(i.width/2,i.height-M,I,M,"blue",D),r.draw(e),P=i.width,m=50,T=m,b=i.height/20;let a=Date.now()%(i.width/2),s=new L(a,0,m,T,"green",b);h.push(s)}window.onload=()=>{j()};let A=!1;document.addEventListener("touchstart",()=>{y=!0,E&&!c&&(d.push(new R(r.x,r.y-r.height/3*2,0,-500,5,"yellow")),N())});function U(){A||(typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent?.requestPermission().then(i=>{i==="granted"?(A=!0,window.addEventListener("deviceorientation",k)):alert("Permission denied.")}).catch(i=>console.error("Permission error 123:",i)):(window.addEventListener("deviceorientation",k),A=!0))}function k(i){const e=i.gamma??0;e<-2?r.currentSpeed=-1*Math.abs(r.speed):e>2?r.currentSpeed=Math.abs(r.speed):r.currentSpeed=0}document.addEventListener("keydown",i=>{if(r)switch(i.key){case"ArrowLeft":r.currentSpeed=-1*Math.abs(r.speed);break;case"ArrowRight":r.currentSpeed=Math.abs(r.speed);break;case" ":case"Spacebar":case"ArrowUp":d.push(new R(r.x,r.y-r.height/3*2,0,-500,5,"yellow")),N();break}});document.addEventListener("keyup",i=>{if(r)switch(i.key){case"ArrowLeft":case"ArrowRight":r.currentSpeed=0;break}});function B(i){if(J())return;if(w=Number(((1+i)/1e3).toFixed(2)),q=Math.max(K-w/10,1),g==-1){g=i,requestAnimationFrame(B);return}let e=i-g;g=i;const a=document.getElementById("gameCanvas");if(!a)return;const s=a.getContext("2d");s&&(s.clearRect(0,0,a.width,a.height),Z(e,s),r.update(e,s),r.draw(s),d.forEach(t=>{t.update(e),t.draw(s)}),d=d.filter(t=>t.y+t.length>0),Y(e,s),requestAnimationFrame(B),s.fillStyle="white",s.font="20px Arial",s.fillText(`Kills: ${C}`,10,30),s.fillText(`Missed: ${v}`,10,60),s.fillText(`Time: ${w.toFixed(0)} s`,10,90))}function Y(i,e){if(h.forEach(t=>{t.update(i)}),g-O>q*1e3){O=g;const t=Math.max(0,(e.canvas.width-P)/2);for(let n=0;n<H;n++){let o=t+Math.floor(Date.now()*Math.random())%(P-m),S=new L(o,0,m,T,"green",b);h.push(S)}}let a=h.length;h=h.filter(t=>t.y<e.canvas.height),v+=a-h.length;let s=[];h.forEach(t=>{let n=[];d.forEach(o=>{if(o.x>=t.x&&o.x<=t.x+t.width&&o.y<=t.y+t.height&&o.y>t.y){s.push(t),n.push(o),C+=1,z(),p.push(new $(t.x,t.y,t.width,t.height,w*1e3+100));return}}),d=d.filter(o=>!n.includes(o)),n=[]}),h=h.filter(t=>!s.includes(t)),p=p.filter(t=>t.shouldDisplay),p.forEach(t=>{t.update(w*1e3),t.draw(e)}),s=[],h.forEach(t=>{t.draw(e)})}function N(){l.getInstance(x).getAudioBufferSource("/games/game1//assets/sounds/laser-gun-shot.wav").then(i=>{i?.start()})}function z(){l.getInstance(x).getAudioBufferSource("/games/game1/assets/sounds/alien-explosion.wav").then(i=>{i?.start()})}function J(){if(c)return!0;if(h.forEach(i=>{if(i.y+i.height>=r.y-r.height/3*2&&i.x+i.width>=r.x-r.width/2&&i.x<=r.x+r.width/2){c=!0;return}}),c=c||v>=10,c){const i=document.getElementById("gameCanvas");if(!i)return;const e=i.getContext("2d");if(!e)return;e.fillStyle="rgba(0, 0, 0, 0.5)",e.fillRect(0,0,i.width,i.height),e.fillStyle="white",e.font="50px Arial",e.fillText("Game Over",i.width/2-100,i.height/2),e.font="30px Arial",e.fillText(`Kills: ${C}`,i.width/2-70,i.height/2+50),e.fillText(`Missed: ${v}`,i.width/2-70,i.height/2+90),e.fillText(`Time: ${w.toFixed(0)} s`,i.width/2-70,i.height/2+130)}return c}function Q(){let i=document.getElementById("game-start-button");E||(E=!0,i&&(i.style.display="none"),_(),y=y||/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent),y&&U(),requestAnimationFrame(B))}function V(i){let e=i.canvas.width,a=i.canvas.height,s=Date.now();for(let t=0;t<G;t++){let n=Math.floor(s*Math.random())%e,o=Math.floor(s*Math.random())%a,S=1+s%3,W=2+s%3;u.push(new F(n,o,S,W,10+s%10))}}function Z(i,e){let a=e.canvas.width;if(u.forEach(s=>{s.update(i)}),u=u.filter(s=>s.y<e.canvas.height),u.length<G){let s=Date.now(),t=1+s%3,n=2+s%3;u.push(new F(Math.floor(s*Math.random())%a,0,t,n,10+s%10))}u.forEach(s=>s.drawStar(g,e))}function _(){const i=document.getElementById("gameCanvas");i&&(i.style.display="block")}l.getInstance(x).loadSoundPool("/games/game1/assets/sounds/laser-gun-shot.wav");l.getInstance(x).loadSoundPool("/games/game1/assets/sounds/alien-explosion.wav");window.startGame=Q;
