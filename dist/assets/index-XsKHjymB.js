(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();class d{static instance;images;constructor(){this.images=new Map}static getInstance(){return d.instance||(d.instance=new d),d.instance}loadImage(e){return new Promise((i,s)=>{if(this.images.has(e)){i(this.images.get(e));return}const t=new Image;t.onload=()=>{this.images.set(e,t),i(t)},t.onerror=s,t.src=e})}async getImage(e){return this.images.has(e)||await this.loadImage(e),this.images.get(e)}}class m{x;y;width;height;color;speed;image;constructor(e,i,s,t,o,h){this.x=e,this.y=i,this.width=s,this.height=t,this.color=o,this.speed=h,this.image=new Image}draw(e){d.getInstance().getImage("/assets/images/alien1.jpg").then(i=>{i&&e.drawImage(i,this.x,this.y,this.width,this.height)})}update(e){this.y+=this.speed*e/1e3}}class x{x;y;vx;vy;length;color;constructor(e,i,s,t,o,h){this.x=e,this.y=i,this.vx=s,this.vy=t,this.length=o,this.color=h}draw(e){e.beginPath(),e.moveTo(this.x,this.y),e.lineTo(this.x,this.y-this.length),e.strokeStyle=this.color,e.lineWidth=5,e.stroke()}update(e){this.y+=this.vy*e/1e3}}class A{x;y;width;height;displayEndTime;shouldDisplay=!0;constructor(e,i,s,t,o){this.x=e,this.y=i,this.width=s,this.height=t,this.displayEndTime=o}draw(e){this.shouldDisplay&&d.getInstance().getImage("/assets/images/explosion.jpg").then(i=>{i&&e.drawImage(i,this.x,this.y,this.width,this.height)})}update(e){e>=this.displayEndTime&&(this.shouldDisplay=!1)}}class T{x;y;width;height;color;speed;currentSpeed;constructor(e,i,s,t,o,h){this.x=e,this.y=i,this.width=s,this.height=t,this.color=o,this.speed=h,this.currentSpeed=0}draw(e){e.beginPath(),e.moveTo(this.x-this.width/2,this.y+this.height/3),e.lineTo(this.x,this.y-this.height/3*2),e.lineTo(this.x+this.width/2,this.y+this.height/3),e.closePath(),e.strokeStyle=this.color,e.stroke(),e.fillStyle=this.color,e.fill()}update(e,i){let s=this.x;this.x+=this.currentSpeed*e/1e3,(this.x>i.canvas.width-this.width/2||this.x<this.width/2)&&(this.x=s)}}class u{static instance;sounds;constructor(){this.sounds=new Map}static getInstance(){return u.instance||(u.instance=new u),u.instance}loadSound(e){return new Promise((i,s)=>{if(this.sounds.has(e)){i(this.sounds.get(e));return}const t=new Audio;t.onloadeddata=()=>{this.sounds.set(e,t),i(t)},t.onerror=s,t.src=e,t.load()})}async getSound(e){return this.sounds.has(e)||await this.loadSound(e),this.sounds.get(e)}}let a,l=[],r=[],c=-1,b=1,L=5,S=5,w=0,v=0,I=0,g=0,f=[];function M(){const n=document.getElementById("gameCanvas");if(!n){console.error("Canvas element not found!");return}const e=n.getContext("2d");if(!e){console.error("Failed to get 2D context!");return}n.width=window.innerWidth,n.height=window.innerHeight,e.fillStyle="black",e.fillRect(0,0,n.width,n.height),a=new T(n.width/2,n.height-50,50,50,"blue",300),a.draw(e);let i=Date.now()%(n.width-50);console.log(i);let s=new m(i,0,50,50,"green",100);r.push(s)}window.onload=()=>{M(),requestAnimationFrame(p)};let y=!1;document.addEventListener("touchstart",()=>{l.push(new x(a.x,a.y-a.height/3*2,0,-500,5,"yellow")),E(),!y&&(window.addEventListener("deviceorientation",n=>{const e=n.gamma??0;e<3?a.currentSpeed=-1*Math.abs(a.speed):e>3?a.currentSpeed=Math.abs(a.speed):a.currentSpeed=0}),y=!0)});document.addEventListener("keydown",n=>{if(a)switch(n.key){case"ArrowLeft":a.currentSpeed=-1*Math.abs(a.speed);break;case"ArrowRight":a.currentSpeed=Math.abs(a.speed);break;case" ":l.push(new x(a.x,a.y-a.height/3*2,0,-500,5,"yellow")),E();break}});document.addEventListener("keyup",n=>{if(a)switch(n.key){case"ArrowLeft":case"ArrowRight":a.currentSpeed=0;break}});function p(n){if(g=Number(((1+n)/1e3).toFixed(2)),S=Math.max(L-g/10,1),c==-1){c=n,requestAnimationFrame(p);return}let e=n-c;c=n;const i=document.getElementById("gameCanvas");if(!i)return;const s=i.getContext("2d");s&&(s.clearRect(0,0,i.width,i.height),s.fillStyle="black",s.fillRect(0,0,i.width,i.height),a.update(e,s),a.draw(s),l.forEach(t=>{t.update(e),t.draw(s)}),l=l.filter(t=>t.y+t.length>0),C(e,s),requestAnimationFrame(p),s.fillStyle="white",s.font="20px Arial",s.fillText(`Kills: ${v}`,10,30),s.fillText(`Missed: ${I}`,10,60),s.fillText(`Time: ${g.toFixed(0)} s`,10,90))}function C(n,e){if(r.forEach(t=>{t.update(n)}),c-w>S*1e3){w=c;for(let t=0;t<b;t++){let o=Math.floor(Date.now()*Math.random())%(e.canvas.width-50),h=new m(o,0,50,50,"green",100);r.push(h)}}let i=r.length;r=r.filter(t=>t.y<e.canvas.height),I+=i-r.length;let s=[];r.forEach(t=>{let o=[];l.forEach(h=>{if(h.x>=t.x&&h.x<=t.x+t.width&&h.y<=t.y+t.height&&h.y>t.y){s.push(t),o.push(h),v+=1,P(),f.push(new A(t.x,t.y,t.width,t.height,g*1e3+100));return}}),l=l.filter(h=>!o.includes(h)),o=[]}),r=r.filter(t=>!s.includes(t)),f=f.filter(t=>t.shouldDisplay),f.forEach(t=>{t.update(g*1e3),t.draw(e)}),s=[],r.forEach(t=>{t.draw(e)})}function E(){u.getInstance().getSound("/assets/sounds/laser-gun-shot.mp3").then(n=>{(n?.cloneNode()).play()})}function P(){u.getInstance().getSound("/assets/sounds/alien-explosion.mp3").then(n=>{(n?.cloneNode(!0)).play()})}
