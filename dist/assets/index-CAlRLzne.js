(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function r(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(t){if(t.ep)return;t.ep=!0;const a=r(t);fetch(t.href,a)}})();class d{static instance;images;constructor(){this.images=new Map}static getInstance(){return d.instance||(d.instance=new d),d.instance}loadImage(e){return new Promise((r,i)=>{if(this.images.has(e)){r(this.images.get(e));return}const t=new Image;t.onload=()=>{this.images.set(e,t),r(t)},t.onerror=i,t.src=e})}async getImage(e){return this.images.has(e)||await this.loadImage(e),this.images.get(e)}}class w{x;y;width;height;color;speed;image;constructor(e,r,i,t,a,h){this.x=e,this.y=r,this.width=i,this.height=t,this.color=a,this.speed=h,this.image=new Image,this.image.src="/assets/images/alien1.jpg"}draw(e){d.getInstance().getImage("/assets/images/alien1.jpg").then(r=>{r&&e.drawImage(r,this.x,this.y,this.width,this.height)})}update(e){this.y+=this.speed*e/1e3}}class p{x;y;vx;vy;length;color;constructor(e,r,i,t,a,h){this.x=e,this.y=r,this.vx=i,this.vy=t,this.length=a,this.color=h}draw(e){e.beginPath(),e.moveTo(this.x,this.y),e.lineTo(this.x,this.y-this.length),e.strokeStyle=this.color,e.lineWidth=5,e.stroke()}update(e){this.y+=this.vy*e/1e3}}class S{x;y;width;height;color;speed;currentSpeed;constructor(e,r,i,t,a,h){this.x=e,this.y=r,this.width=i,this.height=t,this.color=a,this.speed=h,this.currentSpeed=0}draw(e){e.beginPath(),e.moveTo(this.x-this.width/2,this.y+this.height/3),e.lineTo(this.x,this.y-this.height/3*2),e.lineTo(this.x+this.width/2,this.y+this.height/3),e.closePath(),e.strokeStyle=this.color,e.stroke(),e.fillStyle=this.color,e.fill()}update(e,r){let i=this.x;this.x+=this.currentSpeed*e/1e3,(this.x>r.canvas.width-this.width/2||this.x<this.width/2)&&(this.x=i)}}let n,l=[],o=[],c=-1,b=1,A=5,y=5,m=0,v=0,x=0,f=0;function E(){const s=document.getElementById("gameCanvas");if(!s){console.error("Canvas element not found!");return}const e=s.getContext("2d");if(!e){console.error("Failed to get 2D context!");return}s.width=window.innerWidth,s.height=window.innerHeight,e.fillStyle="black",e.fillRect(0,0,s.width,s.height),n=new S(s.width/2,s.height-50,50,50,"blue",300),n.draw(e);let r=Date.now()%(s.width-50);console.log(r);let i=new w(r,0,50,50,"green",100);o.push(i)}window.onload=()=>{E(),requestAnimationFrame(g)};let u=!1;document.addEventListener("click",()=>{u||(window.addEventListener("deviceorientation",s=>{const e=s.gamma??0;e<-3?n.currentSpeed=-1*Math.abs(n.speed):e>3?n.currentSpeed=Math.abs(n.speed):n.currentSpeed=0}),u=!0)});document.addEventListener("touchstart",()=>{l.push(new p(n.x,n.y-n.height/3*2,0,-500,5,"yellow")),!u&&(window.addEventListener("deviceorientation",s=>{const e=s.gamma??0;e<-8?n.currentSpeed=-1*Math.abs(n.speed):e>8?n.currentSpeed=Math.abs(n.speed):n.currentSpeed=0}),u=!0)});document.addEventListener("keydown",s=>{if(n)switch(s.key){case"ArrowLeft":n.currentSpeed=-1*Math.abs(n.speed);break;case"ArrowRight":n.currentSpeed=Math.abs(n.speed);break;case" ":l.push(new p(n.x,n.y-n.height/3*2,0,-500,5,"yellow"));break}});document.addEventListener("keyup",s=>{if(n)switch(s.key){case"ArrowLeft":case"ArrowRight":n.currentSpeed=0;break}});function g(s){if(f=Number(((1+s)/1e3).toFixed(2)),y=Math.max(A-f/10,1),c==-1){c=s,requestAnimationFrame(g);return}let e=s-c;c=s;const r=document.getElementById("gameCanvas");if(!r)return;const i=r.getContext("2d");i&&(i.clearRect(0,0,r.width,r.height),i.fillStyle="black",i.fillRect(0,0,r.width,r.height),n.update(e,i),n.draw(i),l.forEach(t=>{t.update(e),t.draw(i)}),l=l.filter(t=>t.y+t.length>0),I(e,i),requestAnimationFrame(g),i.fillStyle="white",i.font="20px Arial",i.fillText(`Kills: ${v}`,10,30),i.fillText(`Missed: ${x}`,10,60),i.fillText(`Time: ${f.toFixed(0)} s`,10,90))}function I(s,e){if(o.forEach(t=>{t.update(s)}),c-m>y*1e3){m=c;for(let t=0;t<b;t++){let a=Math.floor(Date.now()*Math.random())%(e.canvas.width-50),h=new w(a,0,50,50,"green",100);o.push(h)}}let r=o.length;o=o.filter(t=>t.y<e.canvas.height),x+=r-o.length;let i=[];o.forEach(t=>{let a=[];l.forEach(h=>{if(h.x>=t.x&&h.x<=t.x+t.width&&h.y<=t.y+t.height&&h.y>t.y){i.push(t),a.push(h),v+=1;return}}),l=l.filter(h=>!a.includes(h)),a=[]}),o=o.filter(t=>!i.includes(t)),i=[],o.forEach(t=>{t.draw(e)})}
